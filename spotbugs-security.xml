<?xml version="1.0" encoding="UTF-8"?>
<!--
  SpotBugs Security Filter
  This filter focuses on security-related bugs only
  Based on OWASP Top 10 and common security issues
-->
<FindBugsFilter>
  <!-- High Priority Security Issues -->
  <Match>
    <Bug category="SECURITY"/>
  </Match>

  <!-- SQL Injection -->
  <Match>
    <Bug pattern="SQL_INJECTION"/>
  </Match>

  <!-- Command Injection -->
  <Match>
    <Bug pattern="COMMAND_INJECTION"/>
  </Match>

  <!-- LDAP Injection -->
  <Match>
    <Bug pattern="LDAP_INJECTION"/>
  </Match>

  <!-- XPath Injection -->
  <Match>
    <Bug pattern="XPATH_INJECTION"/>
  </Match>

  <!-- XML External Entity (XXE) -->
  <Match>
    <Bug pattern="XXE"/>
  </Match>

  <!-- Weak Cryptography -->
  <Match>
    <Bug pattern="WEAK_CIPHER,WEAK_HASH,WEAK_RANDOM"/>
  </Match>

  <!-- Hardcoded Secrets -->
  <Match>
    <Bug pattern="HARD_CODE_PASSWORD,HARD_CODE_KEY"/>
  </Match>

  <!-- Insecure Deserialization -->
  <Match>
    <Bug pattern="OBJECT_DESERIALIZATION"/>
  </Match>

  <!-- Path Traversal -->
  <Match>
    <Bug pattern="PATH_TRAVERSAL_IN,PATH_TRAVERSAL_OUT"/>
  </Match>

  <!-- URL Redirection -->
  <Match>
    <Bug pattern="URL_REDIRECT"/>
  </Match>

  <!-- XXE (XML External Entity) -->
  <Match>
    <Bug pattern="XXE"/>
  </Match>

  <!-- SSRF (Server-Side Request Forgery) -->
  <Match>
    <Bug pattern="SSRF"/>
  </Match>

  <!-- Unvalidated Redirect -->
  <Match>
    <Bug pattern="UNVALIDATED_REDIRECT"/>
  </Match>

  <!-- Cookie Security -->
  <Match>
    <Bug pattern="COOKIE_USAGE,INSECURE_COOKIE,HTTPONLY_COOKIE"/>
  </Match>

  <!-- XSS (Cross-Site Scripting) -->
  <Match>
    <Bug pattern="XSS_REQUEST_PARAMETER_TO_JSP_WRITER,XSS_SERVLET"/>
  </Match>

  <!-- Trust Boundary Violation -->
  <Match>
    <Bug pattern="TRUST_BOUNDARY_VIOLATION"/>
  </Match>

  <!-- Weak SSL/TLS -->
  <Match>
    <Bug pattern="WEAK_SSL"/>
  </Match>

  <!-- Header Injection -->
  <Match>
    <Bug pattern="HEADER_INJECTION"/>
  </Match>

  <!-- File Disclosure -->
  <Match>
    <Bug pattern="FILE_DISCLOSURE"/>
  </Match>

  <!-- OS Command Injection -->
  <Match>
    <Bug pattern="OS_CMD_INJECTION"/>
  </Match>

  <!-- JSP Include -->
  <Match>
    <Bug pattern="JSP_INCLUDE"/>
  </Match>

  <!-- Struts Validation -->
  <Match>
    <Bug pattern="STRUTS_VALIDATION"/>
  </Match>

  <!-- Cookie Flag Missing -->
  <Match>
    <Bug pattern="COOKIE_FLAGS_MISSING"/>
  </Match>

  <!-- Spring CSRF -->
  <Match>
    <Bug pattern="SPRING_CSRF_PROTECTION"/>
  </Match>

  <!-- Gadget Potential -->
  <Match>
    <Bug pattern="GADGET_POTENTIAL"/>
  </Match>

  <!-- Information Exposure -->
  <Match>
    <Bug pattern="INFORMATION_EXPOSURE"/>
  </Match>

  <!-- Weak Authentication -->
  <Match>
    <Bug pattern="WEAK_AUTHENTICATION"/>
  </Match>

  <!-- Insecure Configuration -->
  <Match>
    <Bug pattern="INSECURE_CONFIGURATION"/>
  </Match>

  <!-- Exclude test files from security scan -->
  <Match>
    <Source name="~.*Test\.java$"/>
  </Match>

  <Match>
    <Source name="~.*test/.*"/>
  </Match>

  <!-- Exclude generated files -->
  <Match>
    <Source name="~.*generated.*"/>
  </Match>
</FindBugsFilter>
